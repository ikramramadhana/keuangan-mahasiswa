<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#667eea" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="description" content="Aplikasi pengelola keuangan mahasiswa - Catat pemasukan dan pengeluaran dengan mudah" />
  <title>Keuangan Mahasiswa - Smart Money Manager</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json" />
  
  <!-- Icons -->
  <link rel="apple-touch-icon" href="icon-192.png" />
  
  <!-- Tailwind via CDN (untuk prototyping cepat) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js for grafik -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    * {
      font-family: 'Inter', sans-serif;
    }
    
    /* Mobile-first design */
    body {
      touch-action: pan-y;
      -webkit-tap-highlight-color: transparent;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1);
    }
    
    .input-focus {
      transition: all 0.3s ease;
    }
    
    .input-focus:focus {
      transform: translateY(-1px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    .btn-animate {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .btn-animate:active {
      transform: scale(0.95);
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
    
    .stat-card {
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
    }
    
    /* Custom scrollbar for mobile */
    ::-webkit-scrollbar {
      width: 4px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 10px;
    }
    
    /* Mobile optimizations */
    @media (max-width: 768px) {
      .mobile-padding {
        padding: 1rem !important;
      }
      
      .mobile-text-sm {
        font-size: 0.875rem !important;
      }
      
      .mobile-hidden {
        display: none !important;
      }
    }
    
    /* Safe area for notched devices */
    @supports (padding: max(0px)) {
      body {
        padding-left: max(0px, env(safe-area-inset-left));
        padding-right: max(0px, env(safe-area-inset-right));
      }
    }
    
    /* Bottom navigation spacing for mobile */
    .mobile-bottom-space {
      padding-bottom: max(1rem, env(safe-area-inset-bottom));
    }
  </style>
</head>
<body class="gradient-bg flex items-center justify-center p-2 sm:p-4">

  <div class="w-full max-w-6xl bg-white rounded-2xl shadow-2xl overflow-hidden fade-in mx-auto">
    <div id="auth-section" class="p-4 sm:p-8">
      <!-- Header Auth -->
      <div class="text-center mb-6 sm:mb-8">
        <div class="inline-block p-3 sm:p-4 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-full mb-3 sm:mb-4">
          <i class="fas fa-wallet text-white text-3xl sm:text-4xl"></i>
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">Smart Money Manager</h1>
        <p class="text-sm sm:text-base text-gray-500">Kelola keuangan mahasiswa dengan mudah dan praktis</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-8 max-w-4xl mx-auto">
        <!-- Register Card -->
        <div class="bg-gradient-to-br from-green-50 to-emerald-50 p-4 sm:p-6 rounded-xl card-hover border border-green-100">
          <div class="flex items-center mb-3 sm:mb-4">
            <div class="p-2 bg-green-500 rounded-lg mr-2 sm:mr-3">
              <i class="fas fa-user-plus text-white text-sm sm:text-base"></i>
            </div>
            <h2 class="text-xl sm:text-2xl font-bold text-gray-800">Daftar Akun</h2>
          </div>
          <p class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4">Buat akun baru untuk mulai mengelola keuangan</p>
          
          <div class="relative mb-2 sm:mb-3">
            <i class="fas fa-envelope absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
            <input id="regEmail" placeholder="Email" type="email"
              class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500" />
          </div>
          
          <div class="relative mb-3 sm:mb-4">
            <i class="fas fa-lock absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
            <input id="regPassword" type="password" placeholder="Password" 
              class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500" />
          </div>
          
          <button id="btnRegister" 
            class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-2.5 sm:py-3 rounded-lg font-semibold btn-animate hover:from-green-600 hover:to-emerald-700 text-sm sm:text-base">
            <i class="fas fa-user-plus mr-2"></i>Daftar Sekarang
          </button>
        </div>

        <!-- Login Card -->
        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-4 sm:p-6 rounded-xl card-hover border border-blue-100">
          <div class="flex items-center mb-3 sm:mb-4">
            <div class="p-2 bg-blue-500 rounded-lg mr-2 sm:mr-3">
              <i class="fas fa-sign-in-alt text-white text-sm sm:text-base"></i>
            </div>
            <h2 class="text-xl sm:text-2xl font-bold text-gray-800">Masuk</h2>
          </div>
          <p class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4">Sudah punya akun? Silakan login di sini</p>
          
          <div class="relative mb-2 sm:mb-3">
            <i class="fas fa-envelope absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
            <input id="loginEmail" placeholder="Email" type="email"
              class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-blue-500" />
          </div>
          
          <div class="relative mb-3 sm:mb-4">
            <i class="fas fa-lock absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
            <input id="loginPassword" type="password" placeholder="Password" 
              class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-blue-500" />
          </div>
          
          <button id="btnLogin" 
            class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-2.5 sm:py-3 rounded-lg font-semibold btn-animate hover:from-blue-600 hover:to-indigo-700 text-sm sm:text-base">
            <i class="fas fa-sign-in-alt mr-2"></i>Masuk
          </button>
        </div>
      </div>
    </div>

    <!-- Dashboard (hidden sebelum login) -->
    <div id="dashboard" class="hidden p-4 sm:p-8 mobile-bottom-space">
      <!-- Header Dashboard -->
      <div class="flex flex-col gap-3 mb-4 sm:mb-6 pb-4 sm:pb-6 border-b border-gray-200">
        <div>
          <h1 class="text-2xl sm:text-3xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent">
            <i class="fas fa-chart-line mr-2"></i>Dashboard
          </h1>
          <p class="text-xs sm:text-sm text-gray-500 mt-1">Pantau keuangan Anda</p>
        </div>
        <div class="flex items-center justify-between gap-2">
          <div class="flex items-center bg-gray-100 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg flex-1 min-w-0">
            <i class="fas fa-user-circle text-purple-600 mr-2 text-sm sm:text-base flex-shrink-0"></i>
            <span id="userEmail" class="text-xs sm:text-sm font-medium text-gray-700 truncate"></span>
          </div>
          <button id="btnLogout" class="bg-gradient-to-r from-red-500 to-red-600 text-white px-3 sm:px-5 py-1.5 sm:py-2 rounded-lg font-semibold btn-animate hover:from-red-600 hover:to-red-700 text-xs sm:text-sm flex-shrink-0">
            <i class="fas fa-sign-out-alt sm:mr-2"></i><span class="hidden sm:inline">Logout</span>
          </button>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-6 mb-4 sm:mb-8">
        <div class="stat-card bg-gradient-to-br from-green-500 to-emerald-600 p-4 sm:p-6 rounded-xl shadow-lg text-white card-hover">
          <div class="flex items-center justify-between mb-2">
            <div class="text-xs sm:text-sm font-medium opacity-90">Pemasukan</div>
            <div class="p-2 sm:p-3 bg-white bg-opacity-20 rounded-lg">
              <i class="fas fa-arrow-down text-lg sm:text-2xl"></i>
            </div>
          </div>
          <div id="income" class="text-2xl sm:text-4xl font-bold mb-1">Rp 0</div>
          <div class="text-xs sm:text-sm opacity-75">
            <i class="fas fa-chart-line mr-1"></i>Bulan ini
          </div>
        </div>
        
        <div class="stat-card bg-gradient-to-br from-red-500 to-pink-600 p-4 sm:p-6 rounded-xl shadow-lg text-white card-hover">
          <div class="flex items-center justify-between mb-2">
            <div class="text-xs sm:text-sm font-medium opacity-90">Pengeluaran</div>
            <div class="p-2 sm:p-3 bg-white bg-opacity-20 rounded-lg">
              <i class="fas fa-arrow-up text-lg sm:text-2xl"></i>
            </div>
          </div>
          <div id="expense" class="text-2xl sm:text-4xl font-bold mb-1">Rp 0</div>
          <div class="text-xs sm:text-sm opacity-75">
            <i class="fas fa-shopping-cart mr-1"></i>Bulan ini
          </div>
        </div>
        
        <div class="stat-card bg-gradient-to-br from-indigo-500 to-purple-600 p-4 sm:p-6 rounded-xl shadow-lg text-white card-hover">
          <div class="flex items-center justify-between mb-2">
            <div class="text-xs sm:text-sm font-medium opacity-90">Saldo</div>
            <div class="p-2 sm:p-3 bg-white bg-opacity-20 rounded-lg">
              <i class="fas fa-wallet text-lg sm:text-2xl"></i>
            </div>
          </div>
          <div id="balance" class="text-2xl sm:text-4xl font-bold mb-1">Rp 0</div>
          <div class="text-xs sm:text-sm opacity-75">
            <i class="fas fa-coins mr-1"></i>Sisa keuangan
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-8">
        <!-- Form tambah transaksi -->
        <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100 card-hover">
          <div class="flex items-center mb-4 sm:mb-5">
            <div class="p-2 bg-purple-100 rounded-lg mr-2 sm:mr-3">
              <i class="fas fa-plus-circle text-purple-600 text-lg sm:text-xl"></i>
            </div>
            <h2 class="text-lg sm:text-xl font-bold text-gray-800">Tambah Transaksi</h2>
          </div>
          
          <div class="space-y-3 sm:space-y-4">
            <div class="relative">
              <label class="text-xs sm:text-sm font-medium text-gray-700 mb-1 block">Tipe Transaksi</label>
              <div class="relative">
                <i class="fas fa-exchange-alt absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
                <select id="type" class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-purple-500 appearance-none bg-white">
                  <option value="income">ðŸ’° Pemasukan</option>
                  <option value="expense">ðŸ’¸ Pengeluaran</option>
                </select>
              </div>
            </div>
            
            <div class="relative">
              <label class="text-xs sm:text-sm font-medium text-gray-700 mb-1 block">Nominal (Rp)</label>
              <div class="relative">
                <i class="fas fa-money-bill-wave absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
                <input id="amount" type="text" placeholder="10.000 atau 10,000" inputmode="numeric"
                  class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-purple-500" />
              </div>
              <p class="text-xs text-gray-500 mt-1">Format: 1.000.000 atau 1,000,000</p>
            </div>
            
            <div class="relative">
              <label class="text-xs sm:text-sm font-medium text-gray-700 mb-1 block">Kategori</label>
              <div class="relative">
                <i class="fas fa-tag absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
                <input id="category" placeholder="Contoh: Makan, Transport" 
                  class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-purple-500" />
              </div>
            </div>
            
            <div class="relative">
              <label class="text-xs sm:text-sm font-medium text-gray-700 mb-1 block">Catatan (Opsional)</label>
              <div class="relative">
                <i class="fas fa-sticky-note absolute left-3 top-3 sm:top-3.5 text-gray-400 text-sm"></i>
                <input id="note" placeholder="Tambahkan catatan..." 
                  class="w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-purple-500" />
              </div>
            </div>
            
            <button id="saveBtn" 
              class="w-full bg-gradient-to-r from-purple-500 to-indigo-600 text-white py-2.5 sm:py-3 rounded-lg font-semibold btn-animate hover:from-purple-600 hover:to-indigo-700 mt-2 text-sm sm:text-base">
              <i class="fas fa-save mr-2"></i>Simpan Transaksi
            </button>
          </div>
        </div>

        <!-- Grafik -->
        <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100 card-hover">
          <div class="flex items-center mb-4 sm:mb-5">
            <div class="p-2 bg-indigo-100 rounded-lg mr-2 sm:mr-3">
              <i class="fas fa-chart-bar text-indigo-600 text-lg sm:text-xl"></i>
            </div>
            <h2 class="text-lg sm:text-xl font-bold text-gray-800">Grafik Bulanan</h2>
          </div>
          <div class="bg-gray-50 p-2 sm:p-4 rounded-lg">
            <canvas id="chartMonthly" width="400" height="250"></canvas>
          </div>
        </div>
      </div>

      <!-- List transaksi singkat -->
      <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100 card-hover">
        <div class="flex items-center justify-between mb-4 sm:mb-5">
          <div class="flex items-center">
            <div class="p-2 bg-blue-100 rounded-lg mr-2 sm:mr-3">
              <i class="fas fa-history text-blue-600 text-lg sm:text-xl"></i>
            </div>
            <h2 class="text-lg sm:text-xl font-bold text-gray-800">Riwayat</h2>
          </div>
          <span class="text-xs sm:text-sm text-gray-500">50 terakhir</span>
        </div>
        <div class="bg-gray-50 rounded-lg p-2 sm:p-4">
          <ul id="txList" class="space-y-2 sm:space-y-3 max-h-96 overflow-auto"></ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notification Container -->
  <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <!-- Firebase + App scripts -->
  <script type="module" src="./firebase.js"></script>
  <script type="module" src="./app.js"></script>
  
  <!-- PWA Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(registration => console.log('SW registered:', registration))
          .catch(err => console.log('SW registration failed:', err));
      });
    }
  </script>
</body>
</html>
